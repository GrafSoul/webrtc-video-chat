(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{49:function(e,t,n){e.exports=n(97)},54:function(e,t,n){},92:function(e,t){},97:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(44),o=n.n(a),i=(n(54),n(48)),u=n(1),l=n(99),s=function(){return c.a.createElement("header",{className:"header"},c.a.createElement("div",{className:"header-wrap"},c.a.createElement("h1",null,c.a.createElement("span",{className:"logo"},c.a.createElement("img",{src:"images/logo.svg",alt:"Logo"})),"VID.OK")))},m=function(){return c.a.createElement("footer",{className:"footer"},c.a.createElement("p",null,"\xa9 2020 | VID.OK | Created by Dmitriy Zatulovskiy"))},d=n(45),f=n.n(d),E=function(e){var t=e.url;return c.a.createElement(f.a,{value:t,bgColor:"#1d3850",fgColor:"#bebebe",size:200})},h=function(e){var t=e.history,n=Object(l.a)(),r=window.location.href+"room/".concat(n);return c.a.createElement(c.a.Fragment,null,c.a.createElement(s,null),c.a.createElement("div",{className:"container"},c.a.createElement("main",null,c.a.createElement("section",{className:"create-room"},c.a.createElement("div",{className:"crete-info"},c.a.createElement("p",null,c.a.createElement("strong",null,"VID.OK")," - Secure Video Chat. Video transfer and audio stream between browsers interlocutors not giving access to third parties."),c.a.createElement("p",null,"To create a connection, click on the button -"," ",c.a.createElement("strong",null,'"Create Room"')," and send the link to the person with whom you want to communicate.")),c.a.createElement("div",{className:"link-url"},r),c.a.createElement("div",{className:"qrcode"},c.a.createElement(E,{url:r})),c.a.createElement("div",{className:"btn-go"},c.a.createElement("button",{onClick:function(){t.push("/room/".concat(n))}},"Create Room"))))),c.a.createElement(m,null))},v=n(6),g=n(46),p=n.n(g),b=function(e){var t=e.match,n=Object(r.useState)(!0),a=Object(v.a)(n,2),o=a[0],i=a[1],u=Object(r.useState)(!0),l=Object(v.a)(u,2),d=l[0],f=l[1],E=Object(r.useState)(!1),h=Object(v.a)(E,2),g=h[0],b=h[1],k=Object(r.useState)(!1),w=Object(v.a)(k,2),C=w[0],O=w[1],j=Object(r.useRef)(),D=Object(r.useRef)(),N=Object(r.useRef)(),R=Object(r.useRef)(),T=Object(r.useRef)(),y=Object(r.useRef)(),S=Object(r.useRef)([]);function I(e){var t=new RTCPeerConnection({iceServers:[{urls:"stun:stun.stunprotocol.org"},{urls:"turn:numb.viagenie.ca",credential:"muazkh",username:"webrtc@live.com"}]});return t.onicecandidate=M,t.ontrack=K,t.onnegotiationneeded=function(){return function(e){N.current.createOffer().then((function(e){return N.current.setLocalDescription(e)})).then((function(){var t={target:e,caller:R.current.id,sdp:N.current.localDescription};R.current.emit("offer",t)})).catch((function(e){return console.log(e)}))}(e)},t}function V(e){N.current=I();var t=new RTCSessionDescription(e.sdp);N.current.setRemoteDescription(t).then((function(){y.current.getTracks().forEach((function(e){return N.current.addTrack(e,y.current)}))})).then((function(){return N.current.createAnswer()})).then((function(e){return N.current.setLocalDescription(e)})).then((function(){var t={target:e.caller,caller:R.current.id,sdp:N.current.localDescription};R.current.emit("answer",t)}))}function F(e){var t=new RTCSessionDescription(e.sdp);N.current.setRemoteDescription(t).catch((function(e){return console.log(e)}))}function M(e){if(e.candidate){var t={target:T.current,candidate:e.candidate};R.current.emit("ice-candidate",t)}}function x(e){var t=new RTCIceCandidate(e);N.current.addIceCandidate(t).catch((function(e){return console.log(e)}))}function K(e){D.current.srcObject=e.streams[0]}return Object(r.useEffect)((function(){navigator.mediaDevices.getUserMedia({audio:o,video:d}).then((function(e){j.current.srcObject=e,y.current=e,R.current=p.a.connect("/"),R.current.emit("join room",t.params.roomID),R.current.on("other user",(function(e){!function(e){N.current=I(e),y.current.getTracks().forEach((function(e){return S.current.push(N.current.addTrack(e,y.current))}))}(e),T.current=e})),R.current.on("user joined",(function(e){T.current=e})),R.current.on("offer",V),R.current.on("answer",F),R.current.on("ice-candidate",x)}))}),[o,d]),c.a.createElement(c.a.Fragment,null,c.a.createElement(s,null),c.a.createElement("div",{className:"video"},c.a.createElement("video",{autoPlay:!0,ref:D,className:C?"active":null}),c.a.createElement("div",{className:"user-video"},c.a.createElement("video",{autoPlay:!0,muted:!0,ref:j}))),c.a.createElement("div",{className:"stream-control"},c.a.createElement("div",{className:"btn-group"},c.a.createElement("button",{onClick:function(){i(!o)}},"Microphone"),c.a.createElement("button",{onClick:function(){f(!d)}},"Camera"),c.a.createElement("button",{onClick:function(){O(!C)}},"Fullscreen"),c.a.createElement("button",{onClick:function(){navigator.mediaDevices.getDisplayMedia({cursor:!0}).then((function(e){var t=e.getTracks()[0];S.current.find((function(e){return"video"===e.track.kind})).replaceTrack(t),t.onended=function(){S.current.find((function(e){return"video"===e.track.kind})).replaceTrack(y.current.getTracks()[1])}}))}},"Share screen"),c.a.createElement("button",{onClick:function(){return e=window.location.href,void navigator.clipboard.writeText(e).then((function(){console.log("Copied!"),b(!0),setTimeout((function(){return b(!1)}),1e3)})).catch((function(e){console.log("Something went wrong",e)}));var e}},"Copy link")," ",g&&c.a.createElement("span",null,"Copied!"))),c.a.createElement(m,null))};var k=function(){return c.a.createElement(c.a.Fragment,null,c.a.createElement(i.a,null,c.a.createElement(u.c,null,c.a.createElement(u.a,{path:"/",exact:!0,component:h}),c.a.createElement(u.a,{path:"/room/:roomID",component:b}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(k,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[49,1,2]]]);
//# sourceMappingURL=main.7832e226.chunk.js.map