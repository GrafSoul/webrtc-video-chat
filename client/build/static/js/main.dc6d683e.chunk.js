(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{107:function(e,t){},116:function(e,t,a){"use strict";a.r(t);var c=a(0),n=a.n(c),r=a(15),l=a.n(r),i=(a(69),a(62)),s=a(3),o=a(2),m=a(118),u=function(){return n.a.createElement("header",{className:"header"},n.a.createElement("div",{className:"header-wrap"},n.a.createElement("h1",null,n.a.createElement("span",{className:"logo"},n.a.createElement("img",{src:"/images/logo.svg",alt:"Logo"})),"VID.OK")))},d=function(){return n.a.createElement("footer",{className:"footer"},n.a.createElement("p",null,"\xa9 2020 | VID.OK | Created by Dmitriy Zatulovskiy |"," ",n.a.createElement("a",{href:"https://github.com/GrafSoul/webrtc-video-chat",target:"_blank",rel:"noopener noreferrer"},"GitHub")))},h=function(e){var t=e.url,a=Object(c.useState)(!1),r=Object(o.a)(a,2),l=r[0],i=r[1];return n.a.createElement("div",{className:"copy",onClick:function(){return function(e){navigator.clipboard.writeText(e).then((function(){i(!0),setTimeout((function(){i(!1)}),1e3)})).catch((function(e){console.log("Something went wrong",e)}))}(t)}},l&&n.a.createElement("span",{className:"copied"},"Copied!"),n.a.createElement("img",{src:"images/icon_copy.svg",alt:""}))},v=a(57),E=a.n(v),b=function(e){var t=e.url;return n.a.createElement(E.a,{value:t,bgColor:"#1d3850",fgColor:"#bebebe",size:200})},f=function(){return n.a.createElement("div",{className:"socket"},n.a.createElement("div",{className:"gel center-gel"},n.a.createElement("div",{className:"hex-brick h1"}),n.a.createElement("div",{className:"hex-brick h2"}),n.a.createElement("div",{className:"hex-brick h3"})),n.a.createElement("div",{className:"gel c1 r1"},n.a.createElement("div",{className:"hex-brick h1"}),n.a.createElement("div",{className:"hex-brick h2"}),n.a.createElement("div",{className:"hex-brick h3"})),n.a.createElement("div",{className:"gel c2 r1"},n.a.createElement("div",{className:"hex-brick h1"}),n.a.createElement("div",{className:"hex-brick h2"}),n.a.createElement("div",{className:"hex-brick h3"})),n.a.createElement("div",{className:"gel c3 r1"},n.a.createElement("div",{className:"hex-brick h1"}),n.a.createElement("div",{className:"hex-brick h2"}),n.a.createElement("div",{className:"hex-brick h3"})),n.a.createElement("div",{className:"gel c4 r1"},n.a.createElement("div",{className:"hex-brick h1"}),n.a.createElement("div",{className:"hex-brick h2"}),n.a.createElement("div",{className:"hex-brick h3"})),n.a.createElement("div",{className:"gel c5 r1"},n.a.createElement("div",{className:"hex-brick h1"}),n.a.createElement("div",{className:"hex-brick h2"}),n.a.createElement("div",{className:"hex-brick h3"})),n.a.createElement("div",{className:"gel c6 r1"},n.a.createElement("div",{className:"hex-brick h1"}),n.a.createElement("div",{className:"hex-brick h2"}),n.a.createElement("div",{className:"hex-brick h3"})),n.a.createElement("div",{className:"gel c7 r2"},n.a.createElement("div",{className:"hex-brick h1"}),n.a.createElement("div",{className:"hex-brick h2"}),n.a.createElement("div",{className:"hex-brick h3"})),n.a.createElement("div",{className:"gel c8 r2"},n.a.createElement("div",{className:"hex-brick h1"}),n.a.createElement("div",{className:"hex-brick h2"}),n.a.createElement("div",{className:"hex-brick h3"})),n.a.createElement("div",{className:"gel c9 r2"},n.a.createElement("div",{className:"hex-brick h1"}),n.a.createElement("div",{className:"hex-brick h2"}),n.a.createElement("div",{className:"hex-brick h3"})),n.a.createElement("div",{className:"gel c10 r2"},n.a.createElement("div",{className:"hex-brick h1"}),n.a.createElement("div",{className:"hex-brick h2"}),n.a.createElement("div",{className:"hex-brick h3"})),n.a.createElement("div",{className:"gel c11 r2"},n.a.createElement("div",{className:"hex-brick h1"}),n.a.createElement("div",{className:"hex-brick h2"}),n.a.createElement("div",{className:"hex-brick h3"})),n.a.createElement("div",{className:"gel c12 r2"},n.a.createElement("div",{className:"hex-brick h1"}),n.a.createElement("div",{className:"hex-brick h2"}),n.a.createElement("div",{className:"hex-brick h3"})),n.a.createElement("div",{className:"gel c13 r2"},n.a.createElement("div",{className:"hex-brick h1"}),n.a.createElement("div",{className:"hex-brick h2"}),n.a.createElement("div",{className:"hex-brick h3"})),n.a.createElement("div",{className:"gel c14 r2"},n.a.createElement("div",{className:"hex-brick h1"}),n.a.createElement("div",{className:"hex-brick h2"}),n.a.createElement("div",{className:"hex-brick h3"})),n.a.createElement("div",{className:"gel c15 r2"},n.a.createElement("div",{className:"hex-brick h1"}),n.a.createElement("div",{className:"hex-brick h2"}),n.a.createElement("div",{className:"hex-brick h3"})),n.a.createElement("div",{className:"gel c16 r2"},n.a.createElement("div",{className:"hex-brick h1"}),n.a.createElement("div",{className:"hex-brick h2"}),n.a.createElement("div",{className:"hex-brick h3"})),n.a.createElement("div",{className:"gel c17 r2"},n.a.createElement("div",{className:"hex-brick h1"}),n.a.createElement("div",{className:"hex-brick h2"}),n.a.createElement("div",{className:"hex-brick h3"})),n.a.createElement("div",{className:"gel c18 r2"},n.a.createElement("div",{className:"hex-brick h1"}),n.a.createElement("div",{className:"hex-brick h2"}),n.a.createElement("div",{className:"hex-brick h3"})),n.a.createElement("div",{className:"gel c19 r3"},n.a.createElement("div",{className:"hex-brick h1"}),n.a.createElement("div",{className:"hex-brick h2"}),n.a.createElement("div",{className:"hex-brick h3"})),n.a.createElement("div",{className:"gel c20 r3"},n.a.createElement("div",{className:"hex-brick h1"}),n.a.createElement("div",{className:"hex-brick h2"}),n.a.createElement("div",{className:"hex-brick h3"})),n.a.createElement("div",{className:"gel c21 r3"},n.a.createElement("div",{className:"hex-brick h1"}),n.a.createElement("div",{className:"hex-brick h2"}),n.a.createElement("div",{className:"hex-brick h3"})),n.a.createElement("div",{className:"gel c22 r3"},n.a.createElement("div",{className:"hex-brick h1"}),n.a.createElement("div",{className:"hex-brick h2"}),n.a.createElement("div",{className:"hex-brick h3"})),n.a.createElement("div",{className:"gel c23 r3"},n.a.createElement("div",{className:"hex-brick h1"}),n.a.createElement("div",{className:"hex-brick h2"}),n.a.createElement("div",{className:"hex-brick h3"})),n.a.createElement("div",{className:"gel c24 r3"},n.a.createElement("div",{className:"hex-brick h1"}),n.a.createElement("div",{className:"hex-brick h2"}),n.a.createElement("div",{className:"hex-brick h3"})),n.a.createElement("div",{className:"gel c25 r3"},n.a.createElement("div",{className:"hex-brick h1"}),n.a.createElement("div",{className:"hex-brick h2"}),n.a.createElement("div",{className:"hex-brick h3"})),n.a.createElement("div",{className:"gel c26 r3"},n.a.createElement("div",{className:"hex-brick h1"}),n.a.createElement("div",{className:"hex-brick h2"}),n.a.createElement("div",{className:"hex-brick h3"})),n.a.createElement("div",{className:"gel c28 r3"},n.a.createElement("div",{className:"hex-brick h1"}),n.a.createElement("div",{className:"hex-brick h2"}),n.a.createElement("div",{className:"hex-brick h3"})),n.a.createElement("div",{className:"gel c29 r3"},n.a.createElement("div",{className:"hex-brick h1"}),n.a.createElement("div",{className:"hex-brick h2"}),n.a.createElement("div",{className:"hex-brick h3"})),n.a.createElement("div",{className:"gel c30 r3"},n.a.createElement("div",{className:"hex-brick h1"}),n.a.createElement("div",{className:"hex-brick h2"}),n.a.createElement("div",{className:"hex-brick h3"})),n.a.createElement("div",{className:"gel c31 r3"},n.a.createElement("div",{className:"hex-brick h1"}),n.a.createElement("div",{className:"hex-brick h2"}),n.a.createElement("div",{className:"hex-brick h3"})),n.a.createElement("div",{className:"gel c32 r3"},n.a.createElement("div",{className:"hex-brick h1"}),n.a.createElement("div",{className:"hex-brick h2"}),n.a.createElement("div",{className:"hex-brick h3"})),n.a.createElement("div",{className:"gel c33 r3"},n.a.createElement("div",{className:"hex-brick h1"}),n.a.createElement("div",{className:"hex-brick h2"}),n.a.createElement("div",{className:"hex-brick h3"})),n.a.createElement("div",{className:"gel c34 r3"},n.a.createElement("div",{className:"hex-brick h1"}),n.a.createElement("div",{className:"hex-brick h2"}),n.a.createElement("div",{className:"hex-brick h3"})),n.a.createElement("div",{className:"gel c35 r3"},n.a.createElement("div",{className:"hex-brick h1"}),n.a.createElement("div",{className:"hex-brick h2"}),n.a.createElement("div",{className:"hex-brick h3"})),n.a.createElement("div",{className:"gel c36 r3"},n.a.createElement("div",{className:"hex-brick h1"}),n.a.createElement("div",{className:"hex-brick h2"}),n.a.createElement("div",{className:"hex-brick h3"})),n.a.createElement("div",{className:"gel c37 r3"},n.a.createElement("div",{className:"hex-brick h1"}),n.a.createElement("div",{className:"hex-brick h2"}),n.a.createElement("div",{className:"hex-brick h3"})))},g=function(e){var t=e.history,a=Object(c.useState)(!1),r=Object(o.a)(a,2),l=r[0],i=r[1],s=navigator.userAgent.toLowerCase(),v=/trident/gi.test(s)||/msie/gi.test(s)||/edge/gi.test(s);Object(c.useEffect)((function(){setTimeout((function(){return i(!0)}),1e3)}),[]);var E=Object(m.a)(),g=window.location.href+"chat/".concat(E);return n.a.createElement(n.a.Fragment,null,n.a.createElement(u,null),n.a.createElement("div",{className:"container"},n.a.createElement("main",null,v?n.a.createElement("section",{className:"create-chat"},n.a.createElement("div",{className:"crete-info"},n.a.createElement("h2",null,"You are using a browser that does not support the technologies used in this service"),n.a.createElement("p",null,n.a.createElement("strong",null,"VID.OK")," - Secure Video Chat. Video transfer and audio stream between browsers interlocutors not giving access to third parties."))):n.a.createElement("section",{className:"create-chat"},n.a.createElement("div",{className:"crete-info"},n.a.createElement("p",null,n.a.createElement("strong",null,"VID.OK")," - Secure Video Chat. Video transfer and audio stream between browsers interlocutors not giving access to third parties."),n.a.createElement("p",null,"To create a connection, click on the button - ",n.a.createElement("strong",null,'"Create a New Connection"')," ","and send the link to the person with whom you want to communicate.")),n.a.createElement("div",{className:"link-url"},n.a.createElement(h,{url:g}),n.a.createElement("p",null,g)),n.a.createElement("div",{className:"qrcode"},n.a.createElement(b,{url:g})),n.a.createElement("div",{className:"btn-go"},n.a.createElement("button",{onClick:function(){return t.push("/chat/".concat(E)),!1}},"Create a New Connection"))))),n.a.createElement(d,null),!l&&n.a.createElement("div",{className:"loader"},n.a.createElement(f,null)))},N=(a(27),function(e){var t=e.exitRoom;return n.a.createElement("div",{className:"btn-exit-wrap"},n.a.createElement("button",{className:"btn-exit",onClick:t,title:"Exit"},n.a.createElement("span",{className:"icon icon-exit"})))}),k=a(63),p=a(28),x=a.n(p),O=function(e){var t=e.shareLink,a=e.handleShareLink,c=e.handleCopyLink,r=e.copied,l=e.url;return n.a.createElement("div",{className:["link",t?"active":null].join(" ")},n.a.createElement("button",{className:"btn-close",onClick:a,title:"Close"},n.a.createElement("span",{className:"icon icon-close"})),n.a.createElement("h2",null,"Contact link"),n.a.createElement("p",{className:"link-info"},"Copy the link and send it to the person you want to meet in a video chat"),n.a.createElement("p",{className:"link-url"},n.a.createElement("input",{type:"text",value:l,onChange:function(){}})),n.a.createElement("div",{className:"link-copy"},n.a.createElement("button",{onClick:function(){return c(l)}},"Copy link")," ",r&&n.a.createElement("span",{className:"copyed"},"Copied!")),n.a.createElement("p",{className:"link-info"},"Use as an option. Scan QRCode and send the resulting link to the person with who want to start communicating in video chat"),n.a.createElement("div",{className:"link-qrcode"},n.a.createElement(b,{url:l})))},j=a(29),C=a.n(j),y=a(59),w=function(e){var t=e.shareChat,a=e.handleShareChat,c=e.sendMessage,r=e.handleChange,l=e.message,i=e.yourID,s=e.messages;return n.a.createElement("div",{className:["chat",t?"active":null].join(" ")},n.a.createElement("button",{className:"btn-close",onClick:a,title:"Close"},n.a.createElement("span",{className:"icon icon-close"})),n.a.createElement("h2",null,"Chat"),n.a.createElement("div",{className:"chat-wrap"},n.a.createElement(y.a,{className:"chat-container"},s.map((function(e,t){return e.id===i?n.a.createElement("div",{key:t,className:"in-row"},n.a.createElement("div",{className:"in-message"},C.a.emojify(e.body))):n.a.createElement("div",{key:t,className:"out-row"},n.a.createElement("div",{className:"out-message"},C.a.emojify(e.body)))}))),n.a.createElement("form",{className:"chat-form",onSubmit:c},n.a.createElement("textarea",{value:l,className:"chat-write",placeholder:"Write text here...",onChange:r,onKeyPress:function(e){return"Enter"===e.key?c(e):null}}),n.a.createElement("button",{className:"chat-btn"},"Send"))))};document.fullscreenElement||(Object.defineProperty(document,"fullscreenElement",{get:function(){return document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement}}),Object.defineProperty(document,"fullscreenEnabled",{get:function(){return document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled}}));var S=function(e){var t=e.handleShareLink,a=e.handleShareChat,c=e.handleToggleMic,r=e.audio,l=e.handleToggleCamera,i=e.video,s=e.handleToggleSound,o=e.sound,m=e.handleToggleFullScreen,u=e.handleShareMonitor,d=e.handleToggleMirror,h=e.mirror,v=e.update,E=e.fullScreen,b=e.onlyAudio;return n.a.createElement("div",{className:"stream-control"},n.a.createElement("div",{className:"btn-link"},n.a.createElement("button",{className:"btn",onClick:t,title:"Open Link"},n.a.createElement("span",{className:"icon icon-link"}))),n.a.createElement("div",{className:"btn-group"},n.a.createElement("button",{className:"btn",onClick:c,title:"Microphone ON/OFF"},n.a.createElement("span",{className:["icon","icon-mic",r?null:"off"].join(" ")})),n.a.createElement("button",{className:"btn",onClick:s,title:"Sound ON/OFF"},n.a.createElement("span",{className:["icon","icon-sound",o?"off":null].join(" ")})),n.a.createElement("span",{style:b?{display:"none"}:null},n.a.createElement("button",{className:"btn",onClick:l,title:"Camera ON/OFF"},n.a.createElement("span",{className:["icon","icon-camera",i?null:"off"].join(" ")})),n.a.createElement("button",{className:"btn",onClick:d,title:"Mirror"},n.a.createElement("span",{className:["icon","icon-mirror",h?null:"off"].join(" ")})),n.a.createElement("button",{className:"btn",onClick:m,title:"Fullscreen ON/OFF"},n.a.createElement("span",{className:["icon","icon-fullscreen",E?null:"off"].join(" ")}))),v&&!b&&n.a.createElement("button",{className:"btn",onClick:u,title:"Share Content"},n.a.createElement("span",{className:"icon icon-share"}))),n.a.createElement("div",{className:"btn-chat"},n.a.createElement("button",{className:"btn",onClick:a,title:"Open Link"},n.a.createElement("span",{className:"icon icon-chat"}))))},R=function(e){var t=e.userStream,a=e.number,r=e.widthLine,l=e.lineClass,i=e.meterClass,s=e.heightLine,o=e.model,m=Object(c.useRef)(),u=Object(c.useRef)(null),d=Object(c.useRef)(null),h=Object(c.useRef)(a),v=Object(c.useRef)(r),E=Object(c.useRef)(s),b=Object(c.useRef)(o),f=Object(c.useRef)(l),g=Object(c.useRef)([]);return Object(c.useEffect)((function(){var e,a;if(g.current=new Uint8Array(2*h.current),!e){for(var c=0;c<h.current;c++)u.current=document.createElement("div"),u.current.className=f.current,u.current.style.background="#426e92",u.current.style.minWidth=v.current+"px",u.current.style.display="none",m.current.appendChild(u.current);e=new AudioContext,a=e.createAnalyser();try{if(t)e.createMediaStreamSource(t).connect(a);!function e(){if(d.current=document.getElementsByClassName(f.current),!(d.current.length>0))return!1;window.requestAnimationFrame(e),a.getByteFrequencyData(g.current);for(var t=0;t<h.current;t++){var c=g.current[t+h.current];d.current[t].style.minHeight=("small"===b.current?c/3:c)+"px",d.current[t].style.opacity=.008*c,d.current[t].style.display="block",d.current[t].getBoundingClientRect().height>E.current?d.current[t].style.backgroundColor="#a1c7e6":d.current[t].style.backgroundColor="#426e92"}}()}catch(n){alert(n+"\r\nRejected. The page will be updated!")}}}),[t]),n.a.createElement("div",{className:i,ref:m})},T=function(e){var t=e.id,a=e.history,r=e.constraints,l=e.onlyAudio,i=Object(c.useState)(!0),s=Object(o.a)(i,2),m=s[0],u=s[1],d=Object(c.useState)(!0),h=Object(o.a)(d,2),v=h[0],E=h[1],b=Object(c.useState)(!1),g=Object(o.a)(b,2),p=g[0],j=g[1],C=Object(c.useState)(!1),y=Object(o.a)(C,2),T=y[0],M=y[1],F=Object(c.useState)(!1),D=Object(o.a)(F,2),A=D[0],L=D[1],I=Object(c.useState)(!1),U=Object(o.a)(I,2),V=U[0],P=U[1],q=Object(c.useState)(!1),B=Object(o.a)(q,2),G=B[0],z=B[1],H=Object(c.useState)(!1),K=Object(o.a)(H,2),W=K[0],Y=K[1],J=Object(c.useState)(!1),_=Object(o.a)(J,2),Q=_[0],Z=_[1],$=Object(c.useState)(!1),X=Object(o.a)($,2),ee=X[0],te=X[1],ae=Object(c.useState)(!1),ce=Object(o.a)(ae,2),ne=ce[0],re=ce[1],le=Object(c.useState)(!1),ie=Object(o.a)(le,2),se=ie[0],oe=ie[1],me=Object(c.useState)(),ue=Object(o.a)(me,2),de=ue[0],he=ue[1],ve=Object(c.useState)([]),Ee=Object(o.a)(ve,2),be=Ee[0],fe=Ee[1],ge=Object(c.useState)(""),Ne=Object(o.a)(ge,2),ke=Ne[0],pe=Ne[1],xe=Object(c.useRef)(),Oe=Object(c.useRef)(),je=Object(c.useRef)(),Ce=Object(c.useRef)(),ye=Object(c.useRef)(),we=Object(c.useRef)(),Se=Object(c.useRef)([]);function Re(e){var t=new RTCSessionDescription(e.sdp);je.current.setRemoteDescription(t).catch((function(e){return console.log(e)}))}function Te(e){if(e.candidate){var t={target:ye.current,candidate:e.candidate};Ce.current.emit("ice-candidate",t)}}function Me(e){var t=new RTCIceCandidate(e);je.current.addIceCandidate(t).catch((function(e){return console.log(e)}))}function Fe(e){Oe.current.srcObject=e.streams[0]}Object(c.useEffect)((function(){function e(e){var t=new RTCPeerConnection({iceServers:[{urls:"stun:stun.stunprotocol.org"},{urls:"turn:numb.viagenie.ca",credential:"vidokchat",username:"networkroom@live.com"}]});return t.onicecandidate=Te,t.ontrack=Fe,t.onnegotiationneeded=function(){return function(e){je.current.createOffer().then((function(e){return je.current.setLocalDescription(e)})).then((function(){var t={target:e,caller:Ce.current.id,sdp:je.current.localDescription};Ce.current.emit("offer",t)})).catch((function(e){return console.log(e)}))}(e)},t}function a(t){je.current=e();var a=new RTCSessionDescription(t.sdp);je.current.setRemoteDescription(a).then((function(){we.current.getTracks().forEach((function(e){return je.current.addTrack(e,we.current)}))})).then((function(){return je.current.createAnswer()})).then((function(e){return je.current.setLocalDescription(e)})).then((function(){var e={target:t.caller,caller:Ce.current.id,sdp:je.current.localDescription};Ce.current.emit("answer",e)}))}navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia,navigator.mediaDevices.getUserMedia(r).then((function(c){xe.current.srcObject=c,we.current=c,Ce.current=x.a.connect("/"),Ce.current.emit("join room",t),Ce.current.on("other user",(function(t){re(!0),function(t){je.current=e(t),we.current.getTracks().forEach((function(e){return Se.current.push(je.current.addTrack(e,we.current))}))}(t),ye.current=t})),Ce.current.on("user joined",(function(e){ye.current=e})),Ce.current.on("offer",a),Ce.current.on("answer",Re),Ce.current.on("ice-candidate",Me)})),setTimeout((function(){return te(!0)}),1e3)}),[t,r]),Object(c.useEffect)((function(){Ce.current=x.a.connect("/"),Ce.current.on("your id",(function(e){he(e)})),Ce.current.on("message",(function(e){console.log("here"),function(e){fe((function(t){return[].concat(Object(k.a)(t),[e])}))}(e),""!==e&&Z(!0)}))}),[]);var De=function(){return document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen(),oe(!se),!1};function Ae(){Y(!W)}function Le(){Z(!Q)}return n.a.createElement(n.a.Fragment,null,n.a.createElement(N,{exitRoom:function(){a.push("/")}}),l?n.a.createElement(R,{userStream:we.current,number:32,widthLine:10,heightLine:100,lineClass:"line-meter",meterClass:"big-meter",model:"big"}):n.a.createElement(R,{userStream:we.current,number:24,widthLine:3,heightLine:40,lineClass:"line-small-meter",meterClass:"small-meter",model:"small"}),n.a.createElement("div",{className:"video",style:l?{visibility:"hidden"}:null,onClick:De},n.a.createElement("video",{id:"partner",poster:"images/poster.jpg",autoPlay:!0,muted:p,ref:Oe,className:[V?"mirror":null,A?"active":null].join(" ")}),n.a.createElement("div",{className:"user-video"},n.a.createElement("video",{autoPlay:!0,muted:!0,ref:xe,poster:"images/poster.jpg"}))),n.a.createElement(S,{handleShareLink:Ae,handleShareChat:Le,handleToggleMic:function(){null!=we.current&&we.current.getAudioTracks().length>0&&(we.current.getAudioTracks()[0].enabled=!m,u(!m))},audio:m,handleToggleCamera:function(){null!=we.current&&we.current.getVideoTracks().length>0&&(we.current.getVideoTracks()[0].enabled=!v,E(!v))},video:v,handleToggleSound:function(){j(!p)},sound:p,handleToggleFullScreen:function(){L(!A)},handleShareMonitor:function(){if(0===Se.current.length)return!1;navigator.mediaDevices.getDisplayMedia({cursor:!0}).then((function(e){var t=e.getTracks()[0];Se.current.find((function(e){return"video"===e.track.kind})).replaceTrack(t),t.onended=function(){Se.current.find((function(e){return"video"===e.track.kind})).replaceTrack(we.current.getTracks()[1])}}))},handleToggleSettings:function(){z(!G)},handleToggleMirror:function(){P(!V)},otherUser:ye.current,update:ne,mirror:V,fullScreen:A,onlyAudio:l,fullMonitor:se,handleFullscreen:De}),n.a.createElement(O,{shareLink:W,handleShareLink:Ae,handleCopyLink:function(e){navigator.clipboard.writeText(e).then((function(){M(!0),setTimeout((function(){return M(!1)}),1e3)})).catch((function(e){console.log("Something went wrong",e)})),setTimeout((function(){Ae()}),1800)},copied:T,url:window.location.href}),n.a.createElement(w,{shareChat:Q,handleShareChat:Le,sendMessage:function(e){e.preventDefault();var t={body:ke,id:de};pe(""),Ce.current.emit("send message",t)},handleChange:function(e){pe(e.target.value)},yourID:de,message:ke,messages:be}),!ee&&n.a.createElement("div",{className:"loader"},n.a.createElement(f,null)))};function M(){var e=Object(c.useRef)(null),t=Object(c.useRef)(null),a=Object(c.useRef)(null),r=Object(c.useRef)(null),l=Object(c.useRef)(null),i=Object(c.useRef)(null);function s(t){r.current=e.current.createMediaStreamSource(t),l.current=function(e,t,a,c){var n=e.createScriptProcessor(256);return n.onaudioprocess=m,n.clipping=!1,n.lastClip=0,n.volume=0,n.clipLevel=t||.98,n.averaging=a||.95,n.clipLag=c||750,n.connect(e.destination),n.checkClipping=function(){return!!this.clipping&&(this.lastClip+this.clipLag<window.performance.now()&&(this.clipping=!1),this.clipping)},n.shutdown=function(){this.disconnect(),this.onaudioprocess=null},n}(e.current),r.current.connect(l.current),o()}function o(){return a.current.clearRect(0,0,400,10),l.current.checkClipping()?a.current.fillStyle="red":a.current.fillStyle="green",a.current.fillRect(0,0,400*l.current.volume*1.4,10),i.current=window.requestAnimationFrame(o),i.current}function m(e){for(var t,a=e.inputBuffer.getChannelData(0),c=a.length,n=0,r=0;r<c;r++)t=a[r],Math.abs(t)>=this.clipLevel&&(this.clipping=!0,this.lastClip=window.performance.now()),n+=t*t;var l=Math.sqrt(n/c);this.volume=Math.max(l,this.volume*this.averaging)}return Object(c.useEffect)((function(){navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia,a.current=t.current.getContext("2d"),window.AudioContext=window.AudioContext||window.webkitAudioContext,e.current=new AudioContext;try{navigator.getUserMedia({audio:{mandatory:{googEchoCancellation:"false",googAutoGainControl:"false",googNoiseSuppression:"false",googHighpassFilter:"false"},optional:[]}},s,(function(){alert("Stream generation failed.")}))}catch(c){alert("getUserMedia threw exception :"+c)}})),n.a.createElement("div",null,n.a.createElement("canvas",{className:"audio-indicator",id:"meter",height:"10",ref:t}))}function F(e){var t=e.startChat,a=e.handleOnlyAudio,r=e.onlyAudio,l=Object(c.useRef)(),i=Object(c.useRef)(),s=Object(c.useRef)(),o=Object(c.useRef)(),m=Object(c.useRef)();function u(e){return l.current.srcObject=e,navigator.mediaDevices.enumerateDevices()}return Object(c.useEffect)((function(){var e=[i.current,s.current,o.current];function t(t){var a=e.map((function(e){return e.value}));e.forEach((function(e){for(;e.firstChild;)e.removeChild(e.firstChild)}));for(var c=0;c!==t.length;++c){var n=t[c],r=document.createElement("option");r.value=n.deviceId,"audioinput"===n.kind?(r.text=n.label||"microphone ".concat(i.current.length+1),i.current.appendChild(r)):"audiooutput"===n.kind?(r.text=n.label||"speaker ".concat(s.current.length+1),s.current.appendChild(r)):"videoinput"===n.kind?(r.text=n.label||"camera ".concat(o.current.length+1),o.current.appendChild(r)):console.log("Some other kind of source/device: ",n)}e.forEach((function(e,t){Array.prototype.slice.call(e.childNodes).some((function(e){return e.value===a[t]}))&&(e.value=a[t])}))}function c(){var e=i.current.value,a=o.current.value;m.current={audio:{deviceId:e?{exact:e}:void 0},video:!r&&{deviceId:a?{exact:a}:void 0}},navigator.mediaDevices.getUserMedia(m.current).then(u).then(t).catch(n)}function n(e){a(),console.log("navigator.MediaDevices.getUserMedia error: ",e.message,e.name)}s.current.disabled=!("sinkId"in HTMLMediaElement.prototype),navigator.mediaDevices.enumerateDevices().then(t).catch(n),i.current.onchange=c,s.current.onchange=function(){var e,t,a=s.current.value;e=l.current,t=a,"undefined"!==typeof e.sinkId?e.setSinkId(t).then((function(){console.log("Success, audio output device attached: ".concat(t))})).catch((function(e){var t=e;"SecurityError"===e.name&&(t="You need to use HTTPS for selecting audio output device: ".concat(e)),console.error(t),s.current.selectedIndex=0})):console.warn("Browser does not support output device selection.")},o.current.onchange=c,c()}),[r,a]),n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"container"},n.a.createElement("section",{className:"create-chat settings"},n.a.createElement("h2",null,"Configure your ",r?null:"camera and "," audio devices"),r&&n.a.createElement("h3",null,"You do not have a video camera connected,",n.a.createElement("br",null)," you can only communicate by voice"),n.a.createElement("div",{className:[r?"invisible":null]},n.a.createElement("div",{className:"video-content"},n.a.createElement("video",{id:"video",poster:"images/poster.jpg",autoPlay:!0,playsInline:!0,ref:l})),n.a.createElement("div",{className:"select"},n.a.createElement("label",{htmlFor:"videoSource"},"Video source:"),n.a.createElement("select",{id:"videoSource",ref:o}))),n.a.createElement("div",{className:"select"},n.a.createElement("label",{htmlFor:"audioSource"},"Audio input:"),n.a.createElement(M,null),n.a.createElement("select",{id:"audioSource",ref:i})),n.a.createElement("div",{className:"select"},n.a.createElement("label",{htmlFor:"audioOutput"},"Audio output:"),n.a.createElement("select",{id:"audioOutput",ref:s})),n.a.createElement("div",{className:"crete-info"},n.a.createElement("b",null,"Note:")," If you hear a reverb sound your microphone is picking up the output of your speakers/headset, lower the volume and/or move the microphone further away from your speakers/headset."),n.a.createElement("div",{className:"btn-go"},n.a.createElement("button",{onClick:function(){return t(m.current)}},"Start ",r?"Audio":"Video"," Chat")))))}var D=function(e){var t=e.match,a=e.history,r=Object(c.useState)({}),l=Object(o.a)(r,2),i=l[0],s=l[1],m=Object(c.useState)(!1),h=Object(o.a)(m,2),v=h[0],E=h[1],b=Object(c.useState)(!1),g=Object(o.a)(b,2),k=g[0],p=g[1],x=Object(c.useState)(!1),O=Object(o.a)(x,2),j=O[0],C=O[1],y=t.params.id;Object(c.useEffect)((function(){setTimeout((function(){return p(!0)}),1e3)}));return n.a.createElement(n.a.Fragment,null,n.a.createElement(u,null),n.a.createElement(N,{exitRoom:function(){a.push("/")}}),!j&&n.a.createElement(F,{startChat:function(e){s(e),C(!0)},handleOnlyAudio:function(){E(!0)},onlyAudio:v}),j&&n.a.createElement(T,{id:y,history:a,constraints:i,onlyAudio:v}),!k&&n.a.createElement("div",{className:"loader"},n.a.createElement(f,null)),n.a.createElement(d,null))};var A=function(){return n.a.createElement(n.a.Fragment,null,n.a.createElement(i.a,null,n.a.createElement(s.c,null,n.a.createElement(s.a,{path:"/",exact:!0,component:g}),n.a.createElement(s.a,{path:"/chat/:id",component:D}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(A,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},64:function(e,t,a){e.exports=a(116)},69:function(e,t,a){}},[[64,1,2]]]);
//# sourceMappingURL=main.dc6d683e.chunk.js.map